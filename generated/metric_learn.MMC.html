

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>metric_learn.MMC &mdash; metric-learn 0.5.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> metric-learn
          

          
          </a>

          
            
            
              <div class="version">
                0.5.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_guide.html">User Guide</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../metric_learn.html">Package Contents</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../metric_learn.html#module-contents">Module Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metric_learn.html#base-classes">Base Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metric_learn.html#supervised-learning-algorithms">Supervised Learning Algorithms</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../metric_learn.html#weakly-supervised-learning-algorithms">Weakly Supervised Learning Algorithms</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="metric_learn.ITML.html"><code class="docutils literal notranslate"><span class="pre">metric_learn</span></code>.ITML</a></li>
<li class="toctree-l3"><a class="reference internal" href="metric_learn.LSML.html"><code class="docutils literal notranslate"><span class="pre">metric_learn</span></code>.LSML</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">metric_learn</span></code>.MMC</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="metric_learn.SDML.html"><code class="docutils literal notranslate"><span class="pre">metric_learn</span></code>.SDML</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../metric_learn.html#unsupervised-learning-algorithms">Unsupervised Learning Algorithms</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">Examples</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">metric-learn</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../metric_learn.html">metric_learn package</a> &raquo;</li>
        
      <li><code class="docutils literal notranslate"><span class="pre">metric_learn</span></code>.MMC</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/generated/metric_learn.MMC.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="metric-learn-mmc">
<h1><code class="xref py py-mod docutils literal notranslate"><span class="pre">metric_learn</span></code>.MMC<a class="headerlink" href="#metric-learn-mmc" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="metric_learn.MMC">
<em class="property">class </em><code class="descclassname">metric_learn.</code><code class="descname">MMC</code><span class="sig-paren">(</span><em>max_iter=100</em>, <em>max_proj=10000</em>, <em>convergence_threshold=0.001</em>, <em>init=None</em>, <em>A0='deprecated'</em>, <em>diagonal=False</em>, <em>diagonal_c=1.0</em>, <em>verbose=False</em>, <em>preprocessor=None</em>, <em>random_state=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/metric_learn/mmc.html#MMC"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#metric_learn.MMC" title="Permalink to this definition">¶</a></dt>
<dd><p>Mahalanobis Metric for Clustering (MMC)</p>
<p>MMC minimizes the sum of squared distances between similar points, while
enforcing the sum of distances between dissimilar ones to be greater than
one. This leads to a convex and, thus, local-minima-free optimization
problem that can be solved efficiently.
However, the algorithm involves the computation of eigenvalues, which is the
main speed-bottleneck. Since it has initially been designed for clustering
applications, one of the implicit assumptions of MMC is that all classes form
a compact set, i.e., follow a unimodal distribution, which restricts the
possible use-cases of this method. However, it is one of the earliest and a
still often cited technique.</p>
<p>Read more in the <a class="reference internal" href="../weakly_supervised.html#mmc"><span class="std std-ref">User Guide</span></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>max_iter</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional (default=100)</span></dt>
<dd><p class="first last">Maximum number of iterations of the convergence procedure.</p>
</dd>
<dt><strong>max_proj</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional (default=10000)</span></dt>
<dd><p class="first last">Maximum number of projection steps.</p>
</dd>
<dt><strong>convergence_threshold</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional (default=1e-6)</span></dt>
<dd><p class="first last">Convergence threshold for the convergence procedure.</p>
</dd>
<dt><strong>init</strong> <span class="classifier-delimiter">:</span> <span class="classifier">None, string or numpy array, optional (default=None)</span></dt>
<dd><p class="first">Initialization of the Mahalanobis matrix. Possible options are
‘identity’, ‘covariance’, ‘random’, and a numpy array of
shape (n_features, n_features). If None, will be set
automatically to ‘identity’ (this is to raise a warning if
‘init’ is not set, and stays to its default value (None), in v0.5.0).</p>
<blockquote class="last">
<div><dl class="docutils">
<dt>‘identity’</dt>
<dd><p class="first last">An identity matrix of shape (n_features, n_features).</p>
</dd>
<dt>‘covariance’</dt>
<dd><p class="first last">The (pseudo-)inverse of the covariance matrix.</p>
</dd>
<dt>‘random’</dt>
<dd><p class="first last">The initial Mahalanobis matrix will be a random SPD matrix of
shape
<code class="xref any docutils literal notranslate"><span class="pre">(n_features,</span> <span class="pre">n_features)</span></code>, generated using
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_spd_matrix.html#sklearn.datasets.make_spd_matrix" title="(in scikit-learn v0.21.3)"><code class="xref any docutils literal notranslate"><span class="pre">sklearn.datasets.make_spd_matrix</span></code></a>.</p>
</dd>
<dt>numpy array</dt>
<dd><p class="first last">An SPD matrix of shape (n_features, n_features), that will
be used as such to initialize the metric.</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt><strong>verbose</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">if True, prints information while learning</p>
</dd>
<dt><strong>preprocessor</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array-like, shape=(n_samples, n_features) or callable</span></dt>
<dd><p class="first last">The preprocessor to call to get tuples from indices. If array-like,
tuples will be gotten like this: X[indices].</p>
</dd>
<dt><strong>A0</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Not used.</span></dt>
<dd><div class="first last deprecated">
<p><span class="versionmodified">Deprecated since version 0.5.0: </span><code class="xref any docutils literal notranslate"><span class="pre">A0</span></code> was deprecated in version 0.5.0 and will
be removed in 0.6.0. Use ‘init’ instead.</p>
</div>
</dd>
<dt><strong>diagonal</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">if True, a diagonal metric will be learned,
i.e., a simple scaling of dimensions. The initialization will then
be the diagonal coefficients of the matrix given as ‘init’.</p>
</dd>
<dt><strong>diagonal_c</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">weight of the dissimilarity constraint for diagonal
metric learning</p>
</dd>
<dt><strong>verbose</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">if True, prints information while learning</p>
</dd>
<dt><strong>preprocessor</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array-like, shape=(n_samples, n_features) or callable</span></dt>
<dd><p class="first last">The preprocessor to call to get tuples from indices. If array-like,
tuples will be gotten like this: X[indices].</p>
</dd>
<dt><strong>random_state</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or numpy.RandomState or None, optional (default=None)</span></dt>
<dd><p class="first last">A pseudo random number generator object or a seed for it if int. If
<code class="docutils literal notranslate"><span class="pre">init='random'</span></code>, <code class="docutils literal notranslate"><span class="pre">random_state</span></code> is used to initialize the random
transformation.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#metric_learn.MMC" title="metric_learn.MMC"><code class="xref py py-obj docutils literal notranslate"><span class="pre">metric_learn.MMC</span></code></a></dt>
<dd>The original weakly-supervised algorithm</dd>
<dt><a class="reference internal" href="../supervised.html#supervised-version"><span class="std std-ref">Supervised versions of weakly-supervised algorithms</span></a></dt>
<dd>The section of the project documentation that describes the supervised version of weakly supervised estimators.</dd>
</dl>
</div>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="rfbdafd582025-1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td><a class="reference external" href="http://papers.nips.cc/paper/2164-distance-metric-learning-with-application-to-clustering-with-side-information.pdf">Distance metric learning with application to clustering with
side-information</a>
Xing, Jordan, Russell, Ng.</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">metric_learn</span> <span class="k">import</span> <span class="n">MMC_Supervised</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="k">import</span> <span class="n">load_iris</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iris_data</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">iris_data</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">iris_data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mmc</span> <span class="o">=</span> <span class="n">MMC_Supervised</span><span class="p">(</span><span class="n">num_constraints</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mmc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>n_iter_</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><code class="xref any docutils literal notranslate"><span class="pre">int</span></code></a></span></dt>
<dd><p class="first last">The number of iterations the solver has run.</p>
</dd>
<dt><strong>components_</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref any docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>, shape=(n_features, n_features)</span></dt>
<dd><p class="first last">The linear transformation <code class="docutils literal notranslate"><span class="pre">L</span></code> deduced from the learned Mahalanobis
metric (See function <code class="xref any docutils literal notranslate"><span class="pre">components_from_metric</span></code>.)</p>
</dd>
<dt><strong>threshold_</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><code class="xref any docutils literal notranslate"><span class="pre">float</span></code></a></span></dt>
<dd><p class="first last">If the distance metric between two points is lower than this threshold,
points will be classified as similar, otherwise they will be
classified as dissimilar.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#metric_learn.MMC.calibrate_threshold" title="metric_learn.MMC.calibrate_threshold"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calibrate_threshold</span></code></a>(pairs_valid,&nbsp;y_valid[,&nbsp;…])</td>
<td>Decision threshold calibration for pairwise binary classification</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#metric_learn.MMC.decision_function" title="metric_learn.MMC.decision_function"><code class="xref py py-obj docutils literal notranslate"><span class="pre">decision_function</span></code></a>(pairs)</td>
<td>Returns the decision function used to classify the pairs.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#metric_learn.MMC.fit" title="metric_learn.MMC.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a>(pairs,&nbsp;y[,&nbsp;calibration_params])</td>
<td>Learn the MMC model.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#metric_learn.MMC.get_mahalanobis_matrix" title="metric_learn.MMC.get_mahalanobis_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_mahalanobis_matrix</span></code></a>()</td>
<td>Returns a copy of the Mahalanobis matrix learned by the metric learner.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#metric_learn.MMC.get_metric" title="metric_learn.MMC.get_metric"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_metric</span></code></a>()</td>
<td>Returns a function that takes as input two 1D arrays and outputs the learned metric score on these two points.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#metric_learn.MMC.get_params" title="metric_learn.MMC.get_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_params</span></code></a>([deep])</td>
<td>Get parameters for this estimator.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#metric_learn.MMC.metric" title="metric_learn.MMC.metric"><code class="xref py py-obj docutils literal notranslate"><span class="pre">metric</span></code></a>()</td>
<td>Deprecated.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#metric_learn.MMC.predict" title="metric_learn.MMC.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>(pairs)</td>
<td>Predicts the learned metric between input pairs.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#metric_learn.MMC.score" title="metric_learn.MMC.score"><code class="xref py py-obj docutils literal notranslate"><span class="pre">score</span></code></a>(pairs,&nbsp;y)</td>
<td>Computes score of pairs similarity prediction.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#metric_learn.MMC.score_pairs" title="metric_learn.MMC.score_pairs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">score_pairs</span></code></a>(pairs)</td>
<td>Returns the learned Mahalanobis distance between pairs.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#metric_learn.MMC.set_params" title="metric_learn.MMC.set_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_params</span></code></a>(**params)</td>
<td>Set the parameters of this estimator.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#metric_learn.MMC.set_threshold" title="metric_learn.MMC.set_threshold"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_threshold</span></code></a>(threshold)</td>
<td>Sets the threshold of the metric learner to the given value <code class="xref any docutils literal notranslate"><span class="pre">threshold</span></code>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#metric_learn.MMC.transform" title="metric_learn.MMC.transform"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transform</span></code></a>(X)</td>
<td>Embeds data points in the learned linear embedding space.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="metric_learn.MMC.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>max_iter=100</em>, <em>max_proj=10000</em>, <em>convergence_threshold=0.001</em>, <em>init=None</em>, <em>A0='deprecated'</em>, <em>diagonal=False</em>, <em>diagonal_c=1.0</em>, <em>verbose=False</em>, <em>preprocessor=None</em>, <em>random_state=None</em><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.MMC.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="metric_learn.MMC.calibrate_threshold">
<code class="descname">calibrate_threshold</code><span class="sig-paren">(</span><em>pairs_valid</em>, <em>y_valid</em>, <em>strategy='accuracy'</em>, <em>min_rate=None</em>, <em>beta=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.MMC.calibrate_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Decision threshold calibration for pairwise binary classification</p>
<p>Method that calibrates the decision threshold (cutoff point) of the metric
learner. This threshold will then be used when calling the method
<a class="reference internal" href="#metric_learn.MMC.predict" title="metric_learn.MMC.predict"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">predict</span></code></a>. The methods for picking cutoff points make use of traditional
binary classification evaluation statistics such as the true positive and
true negative rates and F-scores. The threshold will be found to maximize
the chosen score on the validation set <code class="docutils literal notranslate"><span class="pre">(pairs_valid,</span> <span class="pre">y_valid)</span></code>.</p>
<p>See more in the <a class="reference internal" href="../weakly_supervised.html#calibration"><span class="std std-ref">User Guide</span></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>strategy</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str, optional (default=’accuracy’)</span></dt>
<dd><p class="first">The strategy to use for choosing the cutoff threshold.</p>
<dl class="last docutils">
<dt>‘accuracy’</dt>
<dd><p class="first last">Selects a decision threshold that maximizes the accuracy.</p>
</dd>
<dt>‘f_beta’</dt>
<dd><p class="first last">Selects a decision threshold that maximizes the f_beta score,
with beta given by the parameter <code class="xref any docutils literal notranslate"><span class="pre">beta</span></code>.</p>
</dd>
<dt>‘max_tpr’</dt>
<dd><p class="first last">Selects a decision threshold that yields the highest true positive
rate with true negative rate at least equal to the value of the
parameter <code class="xref any docutils literal notranslate"><span class="pre">min_rate</span></code>.</p>
</dd>
<dt>‘max_tnr’</dt>
<dd><p class="first last">Selects a decision threshold that yields the highest true negative
rate with true positive rate at least equal to the value of the
parameter <code class="xref any docutils literal notranslate"><span class="pre">min_rate</span></code>.</p>
</dd>
</dl>
</dd>
<dt><strong>beta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float in [0, 1], optional (default=None)</span></dt>
<dd><p class="first last">Beta value to be used in case strategy == ‘f_beta’.</p>
</dd>
<dt><strong>min_rate</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float in [0, 1] or None, (default=None)</span></dt>
<dd><p class="first last">In case strategy is ‘max_tpr’ or ‘max_tnr’ this parameter must be set
to specify the minimal value for the true negative rate or true positive
rate respectively that needs to be achieved.</p>
</dd>
<dt><strong>pairs_valid</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array-like, shape=(n_pairs_valid, 2, n_features)</span></dt>
<dd><p class="first last">The validation set of pairs to use to set the threshold.</p>
</dd>
<dt><strong>y_valid</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array-like, shape=(n_pairs_valid,)</span></dt>
<dd><p class="first last">The labels of the pairs of the validation set to use to set the
threshold. They must be +1 for positive pairs and -1 for negative pairs.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference external" href="https://scikit-learn.org/stable/modules/classes.html#module-sklearn.calibration" title="(in scikit-learn v0.21.3)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sklearn.calibration</span></code></a></dt>
<dd>scikit-learn’s module for calibrating classifiers</dd>
</dl>
</div>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r7670991ef0ee-1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[1]</a></td><td>Receiver-operating characteristic (ROC) plots: a fundamental
evaluation tool in clinical medicine, MH Zweig, G Campbell -
Clinical chemistry, 1993</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r7670991ef0ee-2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[2]</a></td><td>most of the code of this function is from scikit-learn’s PR #10117</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="metric_learn.MMC.decision_function">
<code class="descname">decision_function</code><span class="sig-paren">(</span><em>pairs</em><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.MMC.decision_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the decision function used to classify the pairs.</p>
<p>Returns the opposite of the learned metric value between samples in every
pair, to be consistent with scikit-learn conventions. Hence it should
ideally be low for dissimilar samples and high for similar samples.
This is the decision function that is used to classify pairs as similar
(+1), or dissimilar (-1).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>pairs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array-like, shape=(n_pairs, 2, n_features) or (n_pairs, 2)</span></dt>
<dd><p class="first last">3D Array of pairs to predict, with each row corresponding to two
points, or 2D array of indices of pairs if the metric learner uses a
preprocessor.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>y_predicted</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref any docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of floats, shape=(n_constraints,)</span></dt>
<dd><p class="first last">The predicted decision function value for each pair.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="metric_learn.MMC.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>pairs</em>, <em>y</em>, <em>calibration_params=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/metric_learn/mmc.html#MMC.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#metric_learn.MMC.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Learn the MMC model.</p>
<p>The threshold will be calibrated on the trainset using the parameters
<code class="xref any docutils literal notranslate"><span class="pre">calibration_params</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>pairs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array-like, shape=(n_constraints, 2, n_features) or            (n_constraints, 2)</span></dt>
<dd><p class="first last">3D Array of pairs with each row corresponding to two points,
or 2D array of indices of pairs if the metric learner uses a
preprocessor.</p>
</dd>
<dt><strong>y</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array-like, of shape (n_constraints,)</span></dt>
<dd><p class="first last">Labels of constraints. Should be -1 for dissimilar pair, 1 for similar.</p>
</dd>
<dt><strong>calibration_params</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><code class="xref any docutils literal notranslate"><span class="pre">dict</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref any docutils literal notranslate"><span class="pre">None</span></code></a></span></dt>
<dd><p class="first last">Dictionary of parameters to give to <a class="reference internal" href="#metric_learn.MMC.calibrate_threshold" title="metric_learn.MMC.calibrate_threshold"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">calibrate_threshold</span></code></a> for the
threshold calibration step done at the end of <a class="reference internal" href="#metric_learn.MMC.fit" title="metric_learn.MMC.fit"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">fit</span></code></a>. If <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><code class="xref any docutils literal notranslate"><span class="pre">None</span></code></a> is
given, <a class="reference internal" href="#metric_learn.MMC.calibrate_threshold" title="metric_learn.MMC.calibrate_threshold"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">calibrate_threshold</span></code></a> will use the default parameters.</p>
</dd>
<dt><strong>Returns</strong></dt>
<dd></dd>
<dt><strong>——-</strong></dt>
<dd></dd>
<dt><strong>self</strong> <span class="classifier-delimiter">:</span> <span class="classifier">object</span></dt>
<dd><p class="first last">Returns the instance.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="metric_learn.MMC.get_mahalanobis_matrix">
<code class="descname">get_mahalanobis_matrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.MMC.get_mahalanobis_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of the Mahalanobis matrix learned by the metric learner.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>M</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref any docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>, shape=(n_features, n_features)</span></dt>
<dd><p class="first last">The copy of the learned Mahalanobis matrix.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="metric_learn.MMC.get_metric">
<code class="descname">get_metric</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.MMC.get_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a function that takes as input two 1D arrays and outputs the
learned metric score on these two points.</p>
<p>This function will be independent from the metric learner that learned it
(it will not be modified if the initial metric learner is modified),
and it can be directly plugged into the <a class="reference internal" href="#metric_learn.MMC.metric" title="metric_learn.MMC.metric"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">metric</span></code></a> argument of
scikit-learn’s estimators.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>metric_fun</strong> <span class="classifier-delimiter">:</span> <span class="classifier">function</span></dt>
<dd><p class="first last">The function described above.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#metric_learn.MMC.score_pairs" title="metric_learn.MMC.score_pairs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">score_pairs</span></code></a></dt>
<dd>a method that returns the metric score between several pairs of points. Unlike <a class="reference internal" href="#metric_learn.MMC.get_metric" title="metric_learn.MMC.get_metric"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">get_metric</span></code></a>, this is a method of the metric learner and therefore can change if the metric learner changes. Besides, it can use the metric learner’s preprocessor, and works on concatenated arrays.</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">metric_learn</span> <span class="kn">import</span> <span class="n">NCA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_classification</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nca</span> <span class="o">=</span> <span class="n">NCA</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_classification</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="n">nca</span><span class="o">.</span><span class="n">get_metric</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> 
<span class="go">KNeighborsClassifier(algorithm=&#39;auto&#39;, leaf_size=30,</span>
<span class="go">  metric=&lt;function MahalanobisMixin.get_metric.&lt;locals&gt;.metric_fun</span>
<span class="go">          at 0x...&gt;,</span>
<span class="go">  metric_params=None, n_jobs=None, n_neighbors=5, p=2,</span>
<span class="go">  weights=&#39;uniform&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="metric_learn.MMC.get_params">
<code class="descname">get_params</code><span class="sig-paren">(</span><em>deep=True</em><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.MMC.get_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Get parameters for this estimator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>deep</strong> <span class="classifier-delimiter">:</span> <span class="classifier">boolean, optional</span></dt>
<dd><p class="first last">If True, will return the parameters for this estimator and
contained subobjects that are estimators.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>params</strong> <span class="classifier-delimiter">:</span> <span class="classifier">mapping of string to any</span></dt>
<dd><p class="first last">Parameter names mapped to their values.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="metric_learn.MMC.metric">
<code class="descname">metric</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.MMC.metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Deprecated. Will be removed in v0.6.0. Use <a class="reference internal" href="#metric_learn.MMC.get_mahalanobis_matrix" title="metric_learn.MMC.get_mahalanobis_matrix"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">get_mahalanobis_matrix</span></code></a>
instead</p>
</dd></dl>

<dl class="method">
<dt id="metric_learn.MMC.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>pairs</em><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.MMC.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predicts the learned metric between input pairs. (For now it just
calls decision function).</p>
<p>Returns the learned metric value between samples in every pair. It should
ideally be low for similar samples and high for dissimilar samples.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>pairs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array-like, shape=(n_pairs, 2, n_features) or (n_pairs, 2)</span></dt>
<dd><p class="first last">3D Array of pairs to predict, with each row corresponding to two
points, or 2D array of indices of pairs if the metric learner uses a
preprocessor.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>y_predicted</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref any docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of floats, shape=(n_constraints,)</span></dt>
<dd><p class="first last">The predicted learned metric value between samples in every pair.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="metric_learn.MMC.score">
<code class="descname">score</code><span class="sig-paren">(</span><em>pairs</em>, <em>y</em><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.MMC.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes score of pairs similarity prediction.</p>
<p>Returns the <code class="docutils literal notranslate"><span class="pre">roc_auc</span></code> score of the fitted metric learner. It is
computed in the following way: for every value of a threshold
<code class="docutils literal notranslate"><span class="pre">t</span></code> we classify all pairs of samples where the predicted distance is
inferior to <code class="docutils literal notranslate"><span class="pre">t</span></code> as belonging to the “similar” class, and the other as
belonging to the “dissimilar” class, and we count false positive and
true positives as in a classical <code class="docutils literal notranslate"><span class="pre">roc_auc</span></code> curve.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>pairs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array-like, shape=(n_pairs, 2, n_features) or (n_pairs, 2)</span></dt>
<dd><p class="first last">3D Array of pairs, with each row corresponding to two points,
or 2D array of indices of pairs if the metric learner uses a
preprocessor.</p>
</dd>
<dt><strong>y</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array-like, shape=(n_constraints,)</span></dt>
<dd><p class="first last">The corresponding labels.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>score</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">The <code class="docutils literal notranslate"><span class="pre">roc_auc</span></code> score.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="metric_learn.MMC.score_pairs">
<code class="descname">score_pairs</code><span class="sig-paren">(</span><em>pairs</em><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.MMC.score_pairs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the learned Mahalanobis distance between pairs.</p>
<p>This distance is defined as: <span class="math notranslate nohighlight">\(d_M(x, x') = \sqrt{(x-x')^T M (x-x')}\)</span>
where <code class="docutils literal notranslate"><span class="pre">M</span></code> is the learned Mahalanobis matrix, for every pair of points
<code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">x'</span></code>. This corresponds to the euclidean distance between
embeddings of the points in a new space, obtained through a linear
transformation. Indeed, we have also: <span class="math notranslate nohighlight">\(d_M(x, x') = \sqrt{(x_e -
x_e')^T (x_e- x_e')}\)</span>, with <span class="math notranslate nohighlight">\(x_e = L x\)</span> (See
<code class="xref py py-class docutils literal notranslate"><span class="pre">MahalanobisMixin</span></code>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>pairs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array-like, shape=(n_pairs, 2, n_features) or (n_pairs, 2)</span></dt>
<dd><p class="first last">3D Array of pairs to score, with each row corresponding to two points,
for 2D array of indices of pairs if the metric learner uses a
preprocessor.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>scores: `numpy.ndarray` of shape=(n_pairs,)</strong></dt>
<dd><p class="first last">The learned Mahalanobis distance for every pair.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#metric_learn.MMC.get_metric" title="metric_learn.MMC.get_metric"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_metric</span></code></a></dt>
<dd>a method that returns a function to compute the metric between two points. The difference with <a class="reference internal" href="#metric_learn.MMC.score_pairs" title="metric_learn.MMC.score_pairs"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">score_pairs</span></code></a> is that it works on two 1D arrays and cannot use a preprocessor. Besides, the returned function is independent of the metric learner and hence is not modified if the metric learner is.</dd>
<dt><a class="reference internal" href="../introduction.html#mahalanobis-distances"><span class="std std-ref">Mahalanobis Distances</span></a></dt>
<dd>The section of the project documentation that describes Mahalanobis Distances.</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="metric_learn.MMC.set_params">
<code class="descname">set_params</code><span class="sig-paren">(</span><em>**params</em><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.MMC.set_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<p>The method works on simple estimators as well as on nested objects
(such as pipelines). The latter have parameters of the form
<code class="docutils literal notranslate"><span class="pre">&lt;component&gt;__&lt;parameter&gt;</span></code> so that it’s possible to update each
component of a nested object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>self</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="metric_learn.MMC.set_threshold">
<code class="descname">set_threshold</code><span class="sig-paren">(</span><em>threshold</em><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.MMC.set_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the threshold of the metric learner to the given value <code class="xref any docutils literal notranslate"><span class="pre">threshold</span></code>.</p>
<p>See more in the <a class="reference internal" href="../weakly_supervised.html#calibration"><span class="std std-ref">User Guide</span></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>threshold</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">The threshold value we want to set. It is the value to which the
predicted distance for test pairs will be compared. If they are superior
to the threshold they will be classified as similar (+1),
and dissimilar (-1) if not.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>self</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref any docutils literal notranslate"><span class="pre">_PairsClassifier</span></code></span></dt>
<dd><p class="first last">The pairs classifier with the new threshold set.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="metric_learn.MMC.transform">
<code class="descname">transform</code><span class="sig-paren">(</span><em>X</em><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.MMC.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Embeds data points in the learned linear embedding space.</p>
<p>Transforms samples in <code class="docutils literal notranslate"><span class="pre">X</span></code> into <code class="docutils literal notranslate"><span class="pre">X_embedded</span></code>, samples inside a new
embedding space such that: <code class="docutils literal notranslate"><span class="pre">X_embedded</span> <span class="pre">=</span> <span class="pre">X.dot(L.T)</span></code>, where <code class="docutils literal notranslate"><span class="pre">L</span></code> is
the learned linear transformation (See <code class="xref py py-class docutils literal notranslate"><span class="pre">MahalanobisMixin</span></code>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>X</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref any docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>, shape=(n_samples, n_features)</span></dt>
<dd><p class="first last">The data points to embed.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>X_embedded</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref any docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>, shape=(n_samples, n_components)</span></dt>
<dd><p class="first last">The embedded data points.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<div style='clear:both'></div></div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2019, CJ Carey, Yuan Tang, William de Vazelhes, Aurélien Bellet and Nathalie Vauquier

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>